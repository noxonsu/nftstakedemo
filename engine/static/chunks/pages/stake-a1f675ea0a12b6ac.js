(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{54997:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stake",function(){return n(51817)}])},51817:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var a=n(47568),s=n(14924),r=n(26042),i=n(69396),o=n(10797),u=n(34051),c=n.n(u),p=n(85893),l=n(2593),d=n(35553),y=n(67294),f=n(214),m=n.n(f),h=n(78967),b=n(53419),v=n(15200),k=n(55460),w=n(10783),x=n(67297),T=n.n(x),g=function(e){var t=e.tokenId,n=e.tokenUri,a=e.isApproved,s=e.onDeStake,r=e.onStake,i=e.isFetchUri,o=e.deStakeId,u=e.stakeId,c=e.isStaking,l=e.isDeStaking,d=e.isApproveDo,y=e.isApproveId;return(0,p.jsxs)("div",{className:m().nftBox,children:[!1!==n&&T()(n)?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("h3",{children:["#",t]}),(0,p.jsx)("img",{src:n})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("h3",{children:["#",t]}),i&&(0,p.jsx)("h2",{children:"Fetch info"})]}),null!==s&&(0,p.jsx)("button",{disabled:l||c||d,className:"".concat(m().mainButton," ").concat(m().spacerBottom),onClick:s,children:l&&o===t?(0,p.jsx)(p.Fragment,{children:"De-staking..."}):(0,p.jsx)(p.Fragment,{children:"De-stake"})}),null!==r&&(0,p.jsx)("button",{className:"".concat(m().mainButton," ").concat(m().spacerBottom),onClick:r,disabled:l||c||d,children:c&&u===t?(0,p.jsx)(p.Fragment,{children:"Staking..."}):(0,p.jsx)(p.Fragment,{children:d&&y===t?(0,p.jsx)(p.Fragment,{children:"Approving..."}):(0,p.jsx)(p.Fragment,{children:a?"Stake":"Approve & Stake"})})})]},t.toString())},S=n(64914),N=n.n(S),j=JSON.parse('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"string","name":"tokenURI","type":"string"}],"name":"mintNFT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MAX_SUPPLY","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]'),M=JSON.parse('[{"inputs":[{"internalType":"address","name":"_nftCollection","type":"address"},{"internalType":"contract IERC20","name":"_rewardsToken","type":"address"},{"internalType":"uint256","name":"_rewardsPerHour","type":"uint256"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Paused","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Unpaused","type":"event"},{"inputs":[],"name":"adminWithdrawRewards","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_staker","type":"address"}],"name":"availableRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"claimRewards","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getStakedTokens","outputs":[{"components":[{"internalType":"address","name":"staker","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"internalType":"struct Farm.StakedToken[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"nftCollection","outputs":[{"internalType":"contract IERC721","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"paused","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardsToken","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_rewardsPerHour","type":"uint256"}],"name":"setRewardsPerHour","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"stake","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"stakerAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"stakers","outputs":[{"internalType":"uint256","name":"amountStaked","type":"uint256"},{"internalType":"uint256","name":"timeOfLastUpdate","type":"uint256"},{"internalType":"uint256","name":"unclaimedRewards","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"version","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}]'),F=JSON.parse('[{"constant":false,"inputs":[{"components":[{"name":"target","type":"address"},{"name":"callData","type":"bytes"}],"name":"calls","type":"tuple[]"}],"name":"aggregate","outputs":[{"name":"blockNumber","type":"uint256"},{"name":"returnData","type":"bytes[]"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"blockNumber","type":"uint256"}],"name":"getBlockHash","outputs":[{"name":"blockHash","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getCurrentBlockCoinbase","outputs":[{"name":"coinbase","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getCurrentBlockDifficulty","outputs":[{"name":"difficulty","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getCurrentBlockGasLimit","outputs":[{"name":"gaslimit","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getCurrentBlockTimestamp","outputs":[{"name":"timestamp","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"getEthBalance","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getLastBlockHash","outputs":[{"name":"blockHash","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"}]'),C=n(64262),I=n(81586),A="0xefeffe4d50392998efe4cf46b6fbaa19a58a041a",R="0x8b740b4ad15e2201f291cbfc487977b0ecb5fc84",O=new I.vU(j),E=function(e){console.log(e)},Z=function(){var e=(0,y.useState)(!1),t=e[0],n=e[1],u=(0,y.useState)(!1),f=u[0],x=u[1],T=(0,y.useState)(!1),S=T[0],I=T[1],Z=(0,y.useState)(!1),D=Z[0],_=Z[1],B=(0,y.useState)(!1),U=B[0],P=B[1],L=(0,y.useState)(!1),Y=L[0],H=L[1],W=(0,y.useState)(!1),V=W[0],J=W[1],G=(0,y.useState)(!0),X=(G[0],G[1]),Q=(0,y.useState)(!1),$=Q[0],q=Q[1],z=(0,y.useState)(!1),K=z[0],ee=z[1],te=(0,y.useState)(!1),ne=te[0],ae=te[1],se=(0,y.useState)(!1),re=se[0],ie=se[1],oe=(0,y.useState)(!1),ue=oe[0],ce=oe[1],pe=(0,y.useState)(!0),le=(pe[0],pe[1]),de=(0,y.useState)(!1),ye=(de[0],de[1]),fe=(0,y.useState)(!1),me=fe[0],he=fe[1],be=(0,y.useState)(!0),ve=be[0],ke=be[1],we=(0,y.useState)(!1),xe=we[0],Te=we[1],ge=(0,y.useState)(!1),Se=ge[0],Ne=ge[1],je=(0,y.useState)(!0),Me=(je[0],je[1]),Fe=(0,y.useState)(!0),Ce=Fe[0],Ie=Fe[1],Ae=(0,y.useState)(!1),Re=(Ae[0],Ae[1]),Oe=(0,y.useState)([]),Ee=Oe[0],Ze=Oe[1],De=(0,y.useState)({}),_e=De[0],Be=De[1],Ue=(0,y.useState)(!1),Pe=Ue[0],Le=Ue[1],Ye=(0,y.useState)(!1),He=(Ye[0],Ye[1]),We=(0,y.useState)([]),Ve=We[0],Je=We[1],Ge=(0,y.useState)({}),Xe=Ge[0],Qe=Ge[1],$e=(0,y.useState)(!0),qe=$e[0],ze=$e[1],Ke=(0,y.useState)(!1),et=(Ke[0],Ke[1],(0,y.useState)(!0)),tt=et[0],nt=et[1],at=(0,y.useState)(!1),st=(at[0],at[1]),rt=(0,y.useState)(!1),it=(rt[0],rt[1]),ot=(0,y.useState)(!1),ut=ot[0],ct=ot[1],pt=(0,y.useState)(!1),lt=pt[0],dt=pt[1],yt=(0,y.useState)(!1),ft=yt[0],mt=yt[1],ht=(0,y.useState)(!1),bt=ht[0],vt=ht[1],kt=(0,y.useState)(!1),wt=kt[0],xt=kt[1],Tt=(0,y.useState)(!1),gt=Tt[0],St=Tt[1],Nt=(0,y.useState)(!1),jt=Nt[0],Mt=Nt[1],Ft=(0,y.useState)(!1),Ct=Ft[0],It=Ft[1],At=(0,y.useState)(!1),Rt=(At[0],At[1],(0,y.useState)([])),Ot=Rt[0],Et=Rt[1],Zt=(0,y.useState)(!1);Zt[0],Zt[1];(0,y.useEffect)((function(){var e=setTimeout((function(){var e=(0,o.Z)(Ot);e.shift(),Et(e)}),5e3);return function(){return clearTimeout(e)}}),[Ot]);var Dt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=(0,o.Z)(Ot);n.push({msg:e,style:t}),Et((0,o.Z)(n))},_t=function(e,t){var n=!1;try{n=e.message.replace("Internal JSON-RPC error.",""),n=JSON.parse(n)}catch(a){}switch(n&&n.message?n.message:e.message){case"execution reverted: You don't own this token!":console.log("You dont own this token");break;case"MetaMask Tx Signature: User denied transaction signature.":console.log("Transaction denied");break;case"execution reverted: ERC721: invalid token ID":console.log("Invalid token ID");break;default:console.log("Unkrnown error",e.message)}},Bt=function(){E("do fetchAvailableReward");try{q(!1),X(!0),D.methods.availableRewards(S).call().then((function(e){J(e),X(!1)}))}catch(e){console.log(">>> fail fetchAvailableReward"),_t(e),q(!0)}},Ut=function(){E("do fetchTotalRewardBalance"),ke(!0),Te(!1),ne&&ne.methods.balanceOf(R).call().then((function(e){he(e),ke(!1)})).catch((function(e){Te(!0),console.log(">>> fetchTotalRewardBalance",e),_t(e)}))},Pt=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E("do fetchIsApproved"),Me(!0);try{U.methods.isApprovedForAll(S,R).call().then((function(e){Ne(e),Me(!1)}))}catch(t){console.log(">>> fail check is approved"),_t(t),Me(!1)}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Lt=function(e){return E("do fetchTokenUris"),new Promise((function(t,n){if(S&&U&&Y){var a=e.map((function(e){return{target:A,tokenId:e,callData:O.encodeFunctionData("tokenURI",[e])}}));Y.methods.aggregate(a).call().then((function(n){var a={};n.returnData.forEach((function(t,n){var s=O.decodeFunctionResult("tokenURI",t)[0];a[e[n]]=s})),t(a)})).catch((function(e){_t(e),n()}))}else n()}))},Yt=function(){var e=(0,a.Z)(c().mark((function e(){var t,n,a,s,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E("do fetchUserNfts"),!(S&&U&&Y)||Ce){e.next=33;break}return nt(!0),st(!1),t=!1,n=!1,a=0,s=0,e.prev=8,e.next=11,U.methods.totalSupply().call();case 11:a=e.sent,t=!0,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),console.log("Fail fetch total supply");case 18:return e.prev=18,e.next=21,U.methods.MAX_SUPPLY().call();case 21:s=e.sent,n=!0,e.next=28;break;case 25:e.prev=25,e.t1=e.catch(18),console.log("Fail fetch max supply");case 28:if(console.log("hasMaxSupply",n),console.log("hasTotalSupply",t),console.log("maxSupply",s),console.log("totalSupply",a),n||t){for(it(!0),r=[],i=1;i<=(t?a:s);i++)r.push({target:A,callData:O.encodeFunctionData("ownerOf",[i])});Y.methods.aggregate(r).call().then((function(e){var t=[];e.returnData.forEach((function(e,n){O.decodeFunctionResult("ownerOf",e)[0]===S&&t.push(n+1)})),Je(t),nt(!1),ze(!0),Lt(t).then((function(e){Qe(e),ze(!1)})).catch((function(e){ze(!1)}))})).catch((function(e){console.log(">>> fetchUserNfts",e),st(!0),_t(e)}))}case 33:case"end":return e.stop()}}),e,null,[[8,15],[18,25]])})));return function(){return e.apply(this,arguments)}}();(0,y.useEffect)((function(){Yt()}),[S,U,Y,D,Ce]);(0,y.useEffect)((function(){ne&&(E("on useEffect rewardTokenContract"),ne&&(Te(!1),ye(!1),le(!0),ne.methods.decimals().call().then((function(e){ne.methods.symbol().call().then((function(t){le(!1),ce(e),ie(t),Ut()})).catch((function(e){console.log(">>> reward token info - fail fetch symbol"),Te(!0),ye(!0)}))})).catch((function(e){console.log(">>> reward token info - fail fetch decimals"),Te(!0),ye(!0)}))))}),[ne]),(0,y.useEffect)((function(){D&&S&&(E("on useEffect farmContract && address"),Bt(),E("do fetchStakedNfts"),S&&D&&(Re(!1),He(!1),Ie(!0),D.methods.getStakedTokens(S).call().then((function(e){e=e.map((function(e){return e.tokenId})),Ze(e),Ie(!1),Le(!0),Lt(e).then((function(e){Be(e),Le(!1)})).catch((function(e){Le(!1),He(!0)}))})).catch((function(e){Re(!0),console.log(">>> fail fetchStakedNfts",e),_t(e)}))))}),[S,D]),(0,y.useEffect)((function(){S&&U&&(E("on useEffect address && nftContract"),Pt())}),[S,U]);var Ht=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f||"".concat(t)!="".concat(5)){e.next=4;break}f.eth.getAccounts().then((function(e){I(e[0]);var n=new f.eth.Contract(F,C.Ce[t]);console.log(n),H(n);var a=new f.eth.Contract(j,A);P(a);var s=new f.eth.Contract(N(),"0xaFF4481D10270F50f203E0763e2597776068CBc5");ae(s);var r=new f.eth.Contract(M,R);_(r)})).catch((function(e){console.log(">>> initOnWeb3Ready",e),_t(e)})),e.next=8;break;case 4:return e.next=6,(0,h.IC)();case 6:e.sent&&Xt();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Wt(){return(Wt=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S||!D){e.next=7;break}return ee(!0),Dt("Confirm transaction..."),e.next=5,(0,b.A)(S,D,"claimRewards",[]);case 5:t=e.sent,D.methods.claimRewards().send(t).then((function(e){Bt(),Ut(),ee(!1),Dt("Reward claimed","success")})).catch((function(e){ee(!1),console.log(">>> claimRewards",e),_t(e),Dt("Fail claim reward","error")}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vt(e){return Jt.apply(this,arguments)}function Jt(){return Jt=(0,a.Z)(c().mark((function e(t){var n,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(S&&D&&U)){e.next=22;break}if(n=function(){var e=(0,a.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,dt(!0),mt(t),Dt("Confirm stake transaction"),e.next=6,(0,b.A)(S,D,"stake",[t]);case 6:n=e.sent,D.methods.stake(t).send(n).then((function(){var e=Ee;e.push(t),Ze(e),Be((0,i.Z)((0,r.Z)({},_e),(0,s.Z)({},"".concat(t),Xe[t]))),Je(Ve.filter((function(e){return"".concat(e)!=="".concat(t)}))),Qe((0,i.Z)((0,r.Z)({},Xe),(0,s.Z)({},"".concat(t),!1))),dt(!1),mt(!1),Dt("NFT Staked!","success")})).catch((function(e){Dt("Stake transaction failed","error"),console.log(">> stakeNft",e),_t(e),dt(!1),mt(!1)})),e.next=17;break;case 10:e.prev=10,e.t0=e.catch(0),Dt("Stake transaction failed","error"),console.log(">> stakeNft calc gas",e.t0),_t(e.t0),dt(!1),mt(!1);case 17:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),Se){e.next=21;break}return Mt(t),St(!0),Dt("Confirm approve transaction"),e.prev=6,e.next=9,(0,b.A)(S,U,"setApprovalForAll",[R,!0]);case 9:o=e.sent,U.methods.setApprovalForAll(R,!0).send(o).then(function(){var e=(0,a.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ne(!0),St(!1),Dt("Successfull approved!","success"),n();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Dt("Fail approve transaction","error"),console.log(">> stakeNft do approve",e),St(!1),_t(e)})),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(6),Dt("Fail approve transaction","error"),console.log(">>> stakeNft do approve calc gas",e.t0),St(!1),_t(e.t0);case 19:e.next=22;break;case 21:n();case 22:case"end":return e.stop()}}),e,null,[[6,13]])}))),Jt.apply(this,arguments)}function Gt(){return(Gt=(0,a.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S||!D){e.next=18;break}return e.prev=1,vt(!0),xt(t),Dt("Confirm withdraw transaction"),e.next=7,(0,b.A)(S,D,"withdraw",[t]);case 7:n=e.sent,D.methods.withdraw(t).send(n).then((function(e){var n=Ve;n.push(t),Je(n),Ze(Ee.filter((function(e){return e!==t}))),Qe((0,i.Z)((0,r.Z)({},Xe),(0,s.Z)({},"".concat(t),_e[t]))),Be((0,i.Z)((0,r.Z)({},_e),(0,s.Z)({},"".concat(t),!1))),vt(!1),xt(!1),Dt("NFT withdrawed","success")})).catch((function(e){console.log(">>> withdraw",e),_t(e),vt(!1),xt(!1),Dt("Withdraw NFT transaction failed","error")})),e.next=18;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(">>> withdraw calc gas",e.t0),_t(e.t0),vt(!1),xt(!1),Dt("Withdraw NFT transaction failed","error");case 18:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}(0,y.useEffect)((function(){E("on useEffect activeWeb3 initOnWeb3Ready"),Ht()}),[f]);var Xt=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,h.pE)({onBeforeConnect:function(){It(!0)},onSetActiveChain:n,onConnected:function(e,t){x(t),It(!1)},onError:function(e){console.log(">>>> connectWithMetamask",e),_t(e),It(!1)},needChainId:5});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Qt=(0,p.jsxs)("div",{className:"".concat(m().stakeCustomNftHolder),children:[(0,p.jsx)("b",{children:"Stake NFT by TokenId"}),(0,p.jsx)("input",{type:"number",onChange:function(e){return ct(e.target.value)}}),(0,p.jsx)("button",{className:"".concat(m().mainButton," ").concat(m().spacerBottom),onClick:function(){ut&&(console.log(">>> stake custom nft",ut),Vt(l.O$.from(ut).toNumber()))},disabled:gt||lt||bt,children:Se?"Stake":"Approve & Stake"})]}),$t=function(e){var t=e.message;e.onReload;return(0,p.jsx)("b",{children:t})};return(0,p.jsxs)("div",{className:m().container,children:[(0,v.Z)("stake",!1),(0,k.Z)(),(0,p.jsx)("h1",{className:m().h1,children:(0,w.Q)("Stake Your NFTs - Earn ERC20","StakePage_Title")}),(0,p.jsx)("hr",{className:"".concat(m().divider," ").concat(m().spacerTop)}),S?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h2",{children:"Your reward"}),(0,p.jsxs)("div",{className:m().tokenGrid,children:[(0,p.jsxs)("div",{className:m().tokenItem,children:[(0,p.jsx)("h3",{className:m().tokenLabel,children:"Claimable Rewards"}),(0,p.jsx)("p",{className:m().tokenValue,children:$?(0,p.jsx)(p.Fragment,{children:$t({message:"ERROR"})}):(0,p.jsx)("b",{children:V&&!1!==ue&&!1!==re?"".concat(d.bM(V,ue)," ").concat(re):"Loading..."})})]}),(0,p.jsxs)("div",{className:m().tokenItem,children:[(0,p.jsx)("h3",{className:m().tokenLabel,children:"Stake Farm balance"}),(0,p.jsx)("p",{className:m().tokenValue,children:xe?(0,p.jsx)(p.Fragment,{children:$t({message:"ERROR"})}):(0,p.jsx)("b",{children:ve||!me||!1===ue||!1===re?"Loading...":"".concat(d.bM(me,ue)," ").concat(re)})})]})]}),(0,p.jsx)("hr",{className:"".concat(m().divider," ").concat(m().spacerTop)}),(0,p.jsxs)("b",{children:["Connected wallet ",S]}),(0,p.jsx)("button",{disabled:K,className:"".concat(m().mainButton," ").concat(m().spacerTop),onClick:function(){return function(){return Wt.apply(this,arguments)}()},children:K?"Receiving an award...":"Claim Rewards"}),(0,p.jsx)("hr",{className:"".concat(m().divider," ").concat(m().spacerTop)}),(0,p.jsx)("h2",{children:"Your Staked NFTs"}),(0,p.jsx)("div",{className:m().nftBoxGrid,children:Ce?(0,p.jsx)("p",{className:m().tokenValue,children:(0,p.jsx)("b",{children:"Loading..."})}):(0,p.jsx)(p.Fragment,{children:Ee.length>0?(0,p.jsx)(p.Fragment,{children:null===Ee||void 0===Ee?void 0:Ee.map((function(e){return g({tokenId:e,tokenUri:!!_e[e]&&_e[e],isApproved:Se,onDeStake:function(){return function(e){return Gt.apply(this,arguments)}(e)},onStake:null,isFetchUri:Pe,deStakeId:wt,stakeId:ft,isStaking:lt,isDeStaking:bt,isApproveDo:gt,isApproveId:jt})}))}):(0,p.jsx)("p",{className:m().tokenValue,children:(0,p.jsx)("b",{children:"You dont have staked NFTs."})})})}),(0,p.jsx)("hr",{className:"".concat(m().divider," ").concat(m().spacerTop)}),(0,p.jsx)("h2",{children:"Your Unstaked NFTs"}),Qt,(0,p.jsx)("div",{className:m().nftBoxGrid,children:tt?(0,p.jsx)("p",{className:m().tokenValue,children:(0,p.jsx)("b",{children:"Loading..."})}):(0,p.jsx)(p.Fragment,{children:Ve.length>0?(0,p.jsx)(p.Fragment,{children:null===Ve||void 0===Ve?void 0:Ve.map((function(e){return g({tokenId:e,tokenUri:!!Xe[e]&&Xe[e],isApproved:Se,onDeStake:null,onStake:function(){return Vt(e)},isFetchUri:qe,deStakeId:wt,stakeId:ft,isStaking:lt,isDeStaking:bt,isApproveDo:gt,isApproveId:jt})}))}):(0,p.jsx)("p",{className:m().tokenValue,children:(0,p.jsx)("b",{children:"You dont have Unstaked NFTs."})})})})]}):(0,p.jsx)("button",{disabled:Ct,className:m().mainButton,onClick:Xt,children:Ct?"Connecting":"Connect Wallet"}),!1,Ot.length>0&&(0,p.jsx)("div",{className:m().notifyHolder,children:Ot.map((function(e,t){return(0,p.jsx)("div",{className:"".concat(e.style?m()[e.style]:m().info),children:e.msg},t)}))})]})}},24654:function(){}},function(e){e.O(0,[482,714,955,778,69,774,888,179],(function(){return t=54997,e(e.s=t);var t}));var t=e.O();_N_E=t}]);